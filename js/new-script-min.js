var output=document.getElementById("attribution-text"),outputHTML=document.getElementById("attribution-html"),titleInput=document.getElementById("title"),titleURLInput=document.getElementById("title-url"),titleStr='"This work"',authorInput=document.getElementById("author"),authorURLInput=document.getElementById("author-url"),authorStr="",orgInput=document.getElementById("organisation"),orgURLInput=document.getElementById("organisation-url"),orgStr="",projectInput=document.getElementById("project"),projectURLInput=document.getElementById("project-url"),projectStr="",derivativeURLInput=document.getElementById("derivative-url"),derivativeStr="",licenseSelect=document.getElementById("license-select"),licenseVersion=document.getElementById("version"),licenseStr="",licenseVersionStr="",reset=document.getElementById("reset"),copyAttrButton=document.getElementById("copy-attribution"),copyHtmlButton=document.getElementById("copy-html"),licenseArray=[{value:"CC BY",link:"https://creativecommons.org/licenses/by/",prefix:"is licensed under",text:"Attribution (CC BY)"},{value:"CC BY-SA",link:"https://creativecommons.org/licenses/by-sa/",prefix:"is licensed under",text:"Attribution-ShareAlike (CC BY-SA)"},{value:"CC BY-ND",link:"https://creativecommons.org/licenses/by-nd/",prefix:"is licensed under",text:"Attribution-NoDerivs (CC BY-ND)"},{value:"CC BY-NC",link:"https://creativecommons.org/licenses/by-nc/",prefix:"is licensed under",text:"Attribution-NonCommercial (CC BY-NC)"},{value:"CC BY-NC-SA",link:"https://creativecommons.org/licenses/by-nc-sa/",prefix:"is licensed under",text:"Attribution-NonCommercial-ShareAlike (CC BY-NC-SA)"},{value:"CC BY-NC-ND",link:"https://creativecommons.org/licenses/by-nc-nd/4.0",prefix:"is licensed under",text:"Attribution-NonCommercial-NoDerivs (CC BY-NC-ND)"},{value:"Public Domain",link:"https://wiki.creativecommons.org/Public_domain",prefix:"is in the",text:"Public Domain (General)",noVersion:!0},{value:"Public Domain (CC0)",link:"https://creativecommons.org/publicdomain/zero/1.0/",prefix:"is in the",text:"Public Domain (CC0)",noVersion:!0}];function buildLicenseSelect(){for(var e=0;e<licenseArray.length;e++){var t=document.createElement("option");t.text=licenseArray[e].text,t.value=licenseArray[e].value,licenseSelect.add(t,licenseSelect[e+1])}}function changeTitle(){var e='"'+titleInput.value+'"';titleStr=createLink(e,titleURLInput.value),buildAttribution()}function changeAuthor(){authorStr=" by "+createLink(authorInput.value,authorURLInput.value),buildAttribution()}function changeOrg(){orgStr=", "+createLink(orgInput.value,orgURLInput.value),buildAttribution()}function changeProject(){projectStr=", "+createLink(projectInput.value,projectURLInput.value),buildAttribution()}function changeDerivative(){derivativeStr=" / A derivative from the "+createLink("original work",derivativeURLInput.value),buildAttribution()}function changeLicense(){var e=licenseSelect.selectedIndex-1;if(-1!=e){var t=licenseArray[e].link,n=licenseArray[e].value,i=licenseArray[e].prefix;1==licenseArray[e].noVersion?(licenseVersionStr="",licenseVersion.disabled=!0):(licenseVersionStr=" "+licenseVersion.value,t+=licenseVersion.value,licenseVersion.disabled=!1),licenseStr=" "+i+" "+createLink(n+licenseVersionStr,t),buildAttribution()}}function createLink(e,t){return""==e?"":""==t?"<a>"+e+"</a>":'<a href="'+t+'">'+e+"</a>"}function buildAttribution(){var e=titleStr+authorStr+projectStr+orgStr+licenseStr+derivativeStr;output.innerHTML=e,outputHTML.innerHTML=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function checkURL(e){if(""==e.target.value);else if(isValidUrl(e.target.value)){/^((http|https|ftp):\/\/)/.test(e.target.value)||(e.target.value="https://"+e.target.value)}else;e.target==titleURLInput?(""==titleInput.value&&(titleInput.value="This work"),changeTitle()):e.target==authorURLInput?changeAuthor():e.target==orgURLInput?changeOrg():e.target==projectURLInput?changeProject():e.target==derivativeURLInput&&changeDerivative()}function isValidUrl(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}function resetForm(e){titleInput.value="",titleURLInput.value="",titleStr='"This work"',authorInput.value="",authorURLInput.value="",authorStr="",orgInput.value="",orgURLInput.value="",orgStr="",projectInput.value="",projectURLInput.value="",projectStr="",derivativeURLInput.value="",derivativeStr="";var t=document.getElementById("derivative-check");if(1==t.checked){t.checked=!1;var n=document.getElementById("derivative-url-container");new bootstrap.Collapse(n)}licenseSelect.selectedIndex=0,licenseVersion.selectedIndex=0,licenseStr="",licenseVersionStr="",output.innerHTML="&nbsp;",outputHTML.innerHTML="&nbsp;"}function copyOutput(e){const t=new Blob([output.innerHTML],{type:"text/html"});navigator.clipboard.write([new ClipboardItem({"text/html":t})])}function copyHtml(e){navigator.clipboard.writeText(output.innerHTML)}buildLicenseSelect(),titleInput.addEventListener("input",changeTitle),titleURLInput.addEventListener("input",changeTitle),titleURLInput.addEventListener("focusout",checkURL),authorInput.addEventListener("input",changeAuthor),authorURLInput.addEventListener("input",changeAuthor),authorURLInput.addEventListener("focusout",checkURL),projectInput.addEventListener("input",changeProject),projectURLInput.addEventListener("input",changeProject),projectURLInput.addEventListener("focusout",checkURL),orgInput.addEventListener("input",changeOrg),orgURLInput.addEventListener("input",changeOrg),orgURLInput.addEventListener("focusout",checkURL),derivativeURLInput.addEventListener("input",changeDerivative),derivativeURLInput.addEventListener("focusout",checkURL),licenseSelect.addEventListener("change",changeLicense),licenseVersion.addEventListener("change",changeLicense),reset.addEventListener("click",resetForm),copyAttrButton.addEventListener("click",copyOutput),copyHtmlButton.addEventListener("click",copyHtml);